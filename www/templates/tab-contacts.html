<!-- CC (ContactController) -->

<ion-view>
  <ion-nav-title>
      <h1 style="margin:0;display:inline-block;color:white;font-family:'Londrina Outline',seriff">KiT</h1>
      <img src="img/KiTlogo.png" style="height:65%"/>
  </ion-nav-title>
  <ion-content class="padding contact">

    <!-- Jimmy's contact button -->
    <button class="button button-positive button-block ion-ios-cloud-download-outline" ng-click="CC.getContacts()" ng-disabled="CC.loginView.show"> Import Contact from Phone </button>
    <button class="button button-positive button-block ion-plus-round" ng-click="CC.showAddContactForm = !CC.showAddContactForm" ng-disabled="CC.loginView.show"> Add Contact </button>

    <ka-add-contact ng-show="CC.showAddContactForm"></ka-add-contact>

    <ul class="list" ng-hide="CC.loginView.show">
      <div ng-repeat="contact in CC.contacts.arr">
        <li class="item" >
          <div ng-click="contact.showFormFunc()">
            <h2 style="display: inline">{{contact.name}}</h2>
            <span style="float: right" class="ion-chevron-down" ng-click="contact.showArrowFunc()" ng-show="contact.showArrow"></span>
            <span style="float: right" class="ion-chevron-up" ng-click="contact.showArrowFunc()" ng-show="contact.showArrowUp"></span>
          </div>
          <div ng-show="contact.showForm">
            <p>
              <span class="icon ion-ios-telephone-outline"></span> {{contact.phone}}</br>
              <span class="icon ion-ios-email-outline"></span> {{contact.email}}</br>
              <span class="icon ion-ios-body-outline"></span> {{contact.relationship}}</br>
              <span class="icon ion-ios-bookmarks-outline"></span> {{contact.notes}}</br>
              <span class="ion-ios-time-outline"></span><small> Last contacted: <span am-time-ago="contact.last_contact">{{contact.last_contact}}</span></small></br>

              <button ng-click="contact.showEditFormFunc()" class="button ion-edit"> Edit </button>
              <button ng-click="CC.deleteContact(contact.id)" class="button ion-trash-a"> Remove </button>
            </p>
          </div>

          <!-- Edit form goes here with ng-show="showEdit" -->
          <form name="CC.editContactForm" ng-show="contact.showEditForm" id="edit-contact-form" ng-init="form.name=contact.name; form.phone=contact.phone; form.email=contact.email; form.relationship=contact.relationship; form.freq=contact.frequency_of_contact.toString(); form.notes=contact.notes" novalidate>
            <label class="item item-input item-floating-label">
              <span class="input-label">Name</span>
              <input type="text" placeholder="Name" ng-model="form.name" value="form.name" required>
            </label>
            <label class="item item-input item-floating-label">
              <span class="input-label">Phone</span>
              <input type="tel" placeholder="phone" ng-model="form.phone" value="form.phone" ng-minlength="10" value="contact.phone" required>
              <p><sub>(Note: KiT stores phone numbers exactly as you input them.)</sub></p>
            </label>

            <label class="item item-input item-floating-label">
              <span class="input-label">Email</span>
              <input type="email" placeholder="email" ng-model="form.email">
            </label>
            <div class="list">
              <label class="item item-input item-select">
                <div class="input-label">
                  Choose a Relationship
                </div>
                <select name="relationship" ng-model="form.relationship" value="form.relationship">
                  <option ng-model="form.relationship" value="family">Family</option>
                  <option ng-model="form.relationship" value="social" selected>Social</option>
                  <option ng-model="form.relationship" value="professional">Professional</option>
                </select>
              </label>
            </div>

            <div class="list">
              <label class="item item-input item-select">
                <div class="input-label">
                  Call frequency
                </div>
                <select name="freq" ng-model="form.freq" value="{{form.freq}}">
                  <option value="7">Weekly</option>
                  <option value="14">Bi-Weekly</option>
                  <option value="30" >Monthly</option>
                  <option value="90">Quarterly</option>
                  <option value="180">Bi-Annually</option>
                  <option value="365">Annually</option>
                </select>
              </label>
            </div>
            <label class="item item-input item-floating-label">
              <span class="input-label">Notes</span>
              <input type="text" placeholder="notes" ng-model="form.notes" value="form.notes">
            </label>
            <label class="item item-input item-stacked-label">
              <span class="input-label">Last Contacted</span>
              <input type="date" placeholder="last contacted" ng-model="form.last_contact">
            </label>
            <button ng-click="contact.showEditFormFunc(); CC.setPristine()" class="button button-stable button-block">Close</button>
            <button ng-click="contact.showEditFormFunc(); CC.editContact(form.name, form.phone, form.email, form.relationship, form.freq, form.notes, form.last_contact, contact.id); CC.setPristine(); form = {}" class="button button-stable button-block" style="margin-bottom:7%;">Edit Contact</button>
          </form>
        </li>
  </div>
</ul>

  </ion-content>
</ion-view>
